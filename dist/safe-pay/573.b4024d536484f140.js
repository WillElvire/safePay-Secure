"use strict";(self.webpackChunksafePay=self.webpackChunksafePay||[]).push([[573],{5429:(A,c,o)=>{o.r(c),o.d(c,{LoginComponent:()=>a});var x=o(727),n=o(4650),m=o(6895),r=o(4006),d=o(9481),C=o(5368),S=o(7742),f=o(205),h=o(1102),v=o(3679),z=o(6616),F=o(7044),L=o(1664),u=o(6704),g=o(5635);function T(i,t){if(1&i){const e=n.EpF();n.TgZ(0,"span",9),n.NdJ("click",function(){n.CHM(e);const l=n.oxw();return n.KtG(l.passwordVisible=!l.passwordVisible)}),n.qZA()}if(2&i){const e=n.oxw();n.Q6J("nzType",e.passwordVisible?"eye-invisible":"eye")}}class s{constructor(t,e,p,l){this.fb=t,this.appState=e,this.userQuery=p,this.router=l,this.connectionState=new n.vpe,this.subscription=new x.w0,this.isSpinned=!1,this.passwordVisible=!1}ngOnInit(){this.validateForm=this.fb.group({email:[null,[r.kI.required,r.kI.email]],password:[null,[r.kI.required,r.kI.minLength(6)]]})}submitForm(){return this.verifyUserData()?this.loginUser():this.displayError()}loginUser(){this.isSpinned=!0,this.subscription=this.appState.AppFacades.loginUser(this.validateForm.value).subscribe(this.processAfterLogin())}processAfterLogin(){return{next:t=>{"ACCEPTED"==t.code&&(this.appState.updateUser({user:t.returnObject,token:""}),this.router.navigate(["/"])),this.isSpinned=!1},error:t=>{this.isSpinned=!1,this.appState.AppFacades.mBuildError(t.error.message?t.error.message:t.message),console.log(t)}}}displayError(){Object.values(this.validateForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}verifyUserData(){return this.validateForm.valid}ngOnDestroy(){this.subscription.unsubscribe()}}s.\u0275fac=function(t){return new(t||s)(n.Y36(r.QS),n.Y36(S.B),n.Y36(d.f),n.Y36(f.F0))},s.\u0275cmp=n.Xpm({type:s,selectors:[["app-login-form"]],outputs:{connectionState:"connectionState"},standalone:!0,features:[n._Bn([d.f]),n.jDz],decls:14,vars:5,consts:[["nz-form","",1,"mt-5",3,"formGroup","ngSubmit"],["nzErrorTip","Veuillez renseigner votre email !"],["nzPrefixIcon","mail"],["type","email","nz-input","","formControlName","email","placeholder","email"],["nzErrorTip","Veuillez renseigner votre mot de passe!"],["nzPrefixIcon","lock",3,"nzSuffix"],["type","password","nz-input","","formControlName","password","placeholder","Mot de passe",3,"type"],["suffixTemplate",""],["nz-button","",1,"login-form-button","login-form-margin","col-md-12",3,"nzType","nzLoading"],["nz-icon","",3,"nzType","click"]],template:function(t,e){if(1&t&&(n.ynx(0),n.TgZ(1,"form",0),n.NdJ("ngSubmit",function(){return e.submitForm()}),n.TgZ(2,"nz-form-item")(3,"nz-form-control",1)(4,"nz-input-group",2),n._UZ(5,"input",3),n.qZA()()(),n.TgZ(6,"nz-form-item")(7,"nz-form-control",4)(8,"nz-input-group",5),n._UZ(9,"input",6),n.qZA(),n.YNc(10,T,1,1,"ng-template",null,7,n.W1O),n.qZA()(),n.TgZ(12,"button",8),n._uU(13,"Se connecter"),n.qZA()(),n.BQk()),2&t){const p=n.MAs(11);n.xp6(1),n.Q6J("formGroup",e.validateForm),n.xp6(7),n.Q6J("nzSuffix",p),n.xp6(1),n.Q6J("type",e.passwordVisible?"text":"password"),n.xp6(3),n.Q6J("nzType","primary")("nzLoading",e.isSpinned)}},dependencies:[m.ez,C.l,h.Ls,v.t3,v.SK,z.ix,F.w,L.dQ,u.Lr,u.Nx,u.Fd,g.Zp,g.gB,g.ke,r.UX,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u],styles:["nz-input-group[_ngcontent-%COMP%]{height:6vh}button[_ngcontent-%COMP%]{height:6vh!important;background-color:var(--base-color);color:#000;border:none!important}button[_ngcontent-%COMP%]:hover{background-color:var(--base-color);color:#000;border:none!important}@media (min-width: 0px) and (max-width: 900px){button[_ngcontent-%COMP%]{width:100%!important;height:auto!important}nz-input-group[_ngcontent-%COMP%]{height:6vh!important}}"]});var O=o(4969),y=o(2615),b=o(8043),P=o(7723);function Z(i,t){1&i&&n._UZ(0,"app-login-form")}class a{constructor(t,e){this.userState=t,this.appFacade=e,this.useWeb3=!1}ngOnInit(){}}a.\u0275fac=function(t){return new(t||a)(n.Y36(y.K),n.Y36(b.h))},a.\u0275cmp=n.Xpm({type:a,selectors:[["app-login"]],standalone:!0,features:[n._Bn([y.K,b.h]),n.jDz],decls:5,vars:3,consts:[[1,"mt-2"],[4,"ngIf"],[3,"text","link"]],template:function(t,e){1&t&&(n.ynx(0,0),n._UZ(1,"br")(2,"br"),n.YNc(3,Z,1,0,"app-login-form",1),n.BQk(),n._UZ(4,"app-form-tool",2)),2&t&&(n.xp6(3),n.Q6J("ngIf",!e.useWeb3),n.xp6(1),n.s9C("text","s'inscrire"),n.Q6J("link","/auth/register"))},dependencies:[m.ez,m.O5,s,z.sL,h.PV,f.Bz,O.z,P.g],styles:["@media (min-width: 0px) and (max-width: 900px){button[_ngcontent-%COMP%]{width:100%!important;height:10vh!important}nz-input-group[_ngcontent-%COMP%]{height:auto}}nz-input-group[_ngcontent-%COMP%]{height:6vh}button[_ngcontent-%COMP%]{height:6vh!important;border:1px solid var(--base-color)}button[_ngcontent-%COMP%]:hover{border:1px solid var(--base-color)}"]})}}]);